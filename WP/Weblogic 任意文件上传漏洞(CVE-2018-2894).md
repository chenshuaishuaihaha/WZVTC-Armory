# Weblogic 任意文件上传漏洞（CVE-2018-2894）

## 漏洞简介

​	WebLogic管理端未授权的两个页面存在任意上传getshell漏洞，可直接获取权限。两个页面分别为/ws_utc/begin.do，/ws_utc/config.do。

​	漏洞影响版本：10.3.6.0, 12.1.3.0, 12.2.1.2, 12.2.1.3

## 漏洞复现

​	利用docker启动服务，服务启动后，访问`127.0.0.1:7001/console`

![image-20210319225117290](https://gitee.com/yecp/picgo/raw/master/20210319225124.png)

​	输入用户名`weblogic`，密码`1YjJy6x1`登录进去后，点击`base_domain`的配置，在“高级”中开启“启用 Web 服务测试页”选项：

![image-20210319225558914](https://gitee.com/yecp/picgo/raw/master/20210319225559.png)

​	访问`http://127.0.0.1:7001/ws_utc/config.do`，设置Work Home Dir为`/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css`。我将目录设置为`ws_utc`应用的静态文件css目录，访问这个目录是无需权限的，这一点很重要。

![image-20210319230654611](https://gitee.com/yecp/picgo/raw/master/20210319230654.png)

​	然后点击安全，点击添加，就可以上传任意文件了，这里上传shell.jsp

![image-20210319234601989](https://gitee.com/yecp/picgo/raw/master/20210319234602.png)

​	bp抓包发现这里对后缀名进行了重命名，利用了时间戳

![image-20210319234735638](https://gitee.com/yecp/picgo/raw/master/20210319234735.png)

​		访问http://10.129.242.172:7001/ws_utc/css/config/keystore/1616168780154_shell.jsp

![image-20210319235228927](https://gitee.com/yecp/picgo/raw/master/20210319235229.png)

​	推测这样应该是上传成功了，用冰蝎去去连一下

![image-20210320000645906](https://gitee.com/yecp/picgo/raw/master/20210320000646.png)

​	连接成功

![image-20210320000732954](https://gitee.com/yecp/picgo/raw/master/20210320000733.png)